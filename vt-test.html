<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<meta name="color-scheme" content="light dark" />
		<title>VT Test</title>
		<meta name="description" content="" />
		<meta name="theme-color" content="#0b5fff" />
		<link rel="icon" href="favicon.ico" />
		<style>
			:root {
				--font: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu,
					Cantarell, Noto Sans, Helvetica, Arial, sans-serif;
			}
			* {
				box-sizing: border-box;
			}
			html,
			body {
				height: 100%;
				margin: 0;
			}
			body {
				font-family: var(--font);
				line-height: 1.5;
				-webkit-font-smoothing: antialiased;
				text-rendering: optimizeLegibility;
			}
			img,
			svg,
			video,
			canvas {
				display: block;
				max-width: 100%;
				height: auto;
			}
			input,
			button,
			textarea,
			select {
				font: inherit;
			}
			a {
				color: inherit;
			}
			.container {
				max-width: 72rem;
				margin: 0 auto;
				padding: 1rem;
			}
			.visually-hidden {
				position: absolute !important;
				height: 1px;
				width: 1px;
				overflow: hidden;
				clip: rect(1px, 1px, 1px, 1px);
				white-space: nowrap;
			}
		</style>
	</head>
	<body>
		<a href="#main" class="visually-hidden">Skip to content</a>

		<header class="container">
			<h1>VT Test</h1>
		</header>

		<main id="main" class="container">
			<p>Start here.</p>
		</main>

		<footer class="container">
			<small>&copy; <span id="year"></span></small>
		</footer>

		<script>
			document.getElementById("year").textContent =
				new Date().getFullYear();

			// Add a button to add/remove a div from the body
			const btn = document.createElement("button");
			btn.textContent = "Add box";
			btn.style.margin = "1rem";
			document.querySelector("header.container")?.appendChild(btn);

			const makeBox = () => {
				const box = document.createElement("div");
				box.textContent = "I am a box";
				box.style.cssText = [
					"padding: 1rem;",
					"margin: 1rem;",
					"border-radius: 0.5rem;",
					"background: #0b5fff;",
					"color: white;",
					"max-width: 20rem;",
					"view-transition-name: vt-box;",
					"view-transition-class: vt-box;",
				].join("");
				return box;
			};

			const ensureBox = () => document.getElementById("vt-box");

			const addBox = () => {
				const box = makeBox();
				box.id = "vt-box";
				document.body.appendChild(box);
			};

			const removeBox = () => {
				const box = ensureBox();
				if (box) box.remove();
			};

			const withVT = (fn) => {
				if (document.startViewTransition) {
					document.startViewTransition(fn);
				} else {
					fn();
				}
			};

			btn.addEventListener("click", () => {
				const exists = !!ensureBox();
				btn.textContent = exists ? "Add box" : "Remove box";
				withVT(() => {
					exists ? removeBox() : addBox();
				});
			});
		</script>
	</body>
</html>
